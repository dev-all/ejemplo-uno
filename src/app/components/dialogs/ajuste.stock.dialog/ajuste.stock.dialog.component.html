<div class="modal-container">
  <h2 mat-dialog-title>
    AJUSTE DE STOCK
    <br />
  </h2>

  <div class="description">
    <h2>{{ this.descripcionProducto }}</h2>
  </div>

  <div mat-dialog-content class="dialog-content">
    <div class="ajuste-wrap">
      <form class="form-wrap" (ngSubmit)="createRegistro()">
        <mat-form-field
          [className]="
            !spanDeposito
              ? ' span-grid-1-3'
              : 'not-span mat-form-field  ng-tns-c91-17 mat-primary mat-form-field-type-mat-select mat-form-field-appearance-fill mat-form-field-can-float mat-form-field-has-label ng-pristine ng-valid ng-star-inserted mat-form-field-should-float ng-touched'
          "
          appearance="fill"
        >
          <mat-label>Depósito</mat-label>
          <mat-select
            [(ngModel)]="depositoSelected"
            name="deposito"
            (selectionChange)="calcularValores('deposito')"
          >
            <mat-option
              *ngFor="let deposito of depositos | distinct: 'Numero'"
              [value]="deposito.Numero"
            >
              {{ deposito.Detalle }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field *ngIf="this.variantes.length > 0" appearance="fill">
          <mat-label>Variante</mat-label>
          <mat-select
            [(ngModel)]="varianteSelected"
            (selectionChange)="calcularValores('variante')"
            name="variante"
          >
            <mat-option
              *ngFor="let variante of variantes"
              [value]="variante.IdVariante"
            >
              {{ variante.DetalleVariante }} {{ variante.CodigoVariante }}
              {{ variante.DescripcionColor }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field class="span-grid-1-3" appearance="outline">
          <mat-label>Cantidad</mat-label>
          <input
            matInput
            type="number"
            oninput="this.value = !!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null"
            min="0"
            [formControl]="cantidadFormControl"
            autocomplete="off"
            (input)="calcularTipoAjuste()"
          />
          <div
            class="clear-option"
            mat-button
            *ngIf="cantidadFormControl.value"
            matSuffix
            mat-icon-button
            aria-label="Clear"
            (click)="cantidadFormControl.setValue('')"
          >
            <mat-icon>close</mat-icon>
          </div>
        </mat-form-field>
        <mat-radio-group
          class="radio-group span-grid-1-3"
          [(ngModel)]="tipoAjuste"
          (change)="calcularTipoAjuste()"
          name="tipoAjuste"
          [disabled]="this.bloquearRadios"
        >
          <div class="radio-button-appearance">
            <mat-radio-button class="example-margin" value="1"
              >Sumar</mat-radio-button
            >
          </div>

          <div class="ml-1 radio-button-appearance">
            <mat-radio-button class="example-margin" value="2"
              >Restar</mat-radio-button
            >
          </div>

          <div class="ml-1 radio-button-appearance">
            <mat-radio-button class="example-margin" value="3"
              >Establecer</mat-radio-button
            >
          </div>
        </mat-radio-group>

        <mat-form-field class="mt-1 span-grid-1-3" appearance="outline">
          <mat-label>Descripción</mat-label>
          <input matInput type="text" [formControl]="descripcionFormControl" />
          <div
            class="clear-option"
            mat-button
            *ngIf="descripcionFormControl.value"
            matSuffix
            mat-icon-button
            aria-label="Clear"
            (click)="descripcionFormControl.setValue('')"
          >
            <mat-icon>close</mat-icon>
          </div>
        </mat-form-field>

        <div class="button-wrap">
          <button class="ml-1" mat-raised-button color="primary">
            <span>Guardar</span>
          </button>
        </div>
      </form>

      <div class="calculos-container">
        <div class="calculo-wrap">
          <div class="text-left leyenda">
            <span>Stock Actual</span>
          </div>

          <div class="text-right monto">
            <span>{{ stockActual |  currency:'es-AR':'' }}</span>
          </div>
        </div>

        <div class="mt-1 text-left calculo-wrap">
          <div class="leyenda">
            <span>Ajuste</span>

            <div class="ml-1 icon-wrap">
              <span *ngIf="this.iconoAjuste == 1" class="material-icons">
                add
              </span>

              <span *ngIf="this.iconoAjuste == 2" class="material-icons">
                remove
              </span>

              <span *ngIf="this.iconoAjuste > 2" class="material-icons"> </span>
            </div>
          </div>

          <div class="text-right monto">
            <span>{{ cantidadAjuste |  currency:'es-AR':'' }}</span>
          </div>
        </div>

        <hr class="mt-1" />

        <div class="mt-1 calculo-wrap">
          <div class="text-left leyenda">
            <span>Stock Final</span>
          </div>

          <div class="text-right monto">
            <span>{{ stockFinal |  currency:'es-AR':'' }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="grid-wrap">
      <app-stock-grid
        [stocks]="this.stocks"
        [selectIdStock]="this.selectIdStock"
      ></app-stock-grid>
    </div>
  </div>

  <div mat-dialog-actions class="mt-2 dialog-actions">
    <button mat-button mat-dialog-close>Salir</button>
  </div>
</div>
<app-global-spinner></app-global-spinner>
