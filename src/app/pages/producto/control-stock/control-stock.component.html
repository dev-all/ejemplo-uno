
<mat-card-content class="card-magnum-content">
  <div class="card-magnum-content__wrapper">
    <mat-card class="card-magnum-content__item-wrapper">
      <mat-card-title> Control de Stock</mat-card-title>
      <mat-card-subtitle>Productos	</mat-card-subtitle>
      <div class="card-magnum-content__headings">

        <mat-card class="example-card">
          <mat-card-header>
            <mat-card-title></mat-card-title>
            <mat-card-subtitle>Buscar productos</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>

            <form class="form-wrap" [formGroup]="myForm" (ngSubmit)="getByProducto_Change()">
              <!-- codigo -->
              <mat-form-field class="input" style="width: 30%; min-width: 150px;">
                <mat-label>Buscar Producto </mat-label>
                <input matInput (inputChange)="getByProducto_Change()" type="text" id="codigo" formControlName="codigo">
                <mat-hint>No buscar por descripci√≥n</mat-hint>
              </mat-form-field>

              <!-- Proveedor -->
              <mat-form-field class="input" style="width: 30%; min-width: 150px;">
                <mat-label>Proveedor</mat-label>
                <mat-select formControlName="proveedor" id="proveedor">
                  <mat-option>Seleccion un proveedor</mat-option>
                  <mat-option *ngFor="let proveedor of proveedoresSource" [value]="proveedor.Codigo">
                    {{proveedor.Nombre}}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-card-actions>
                <button mat-raised-button color="primary" style="width: 100%; min-width: 150px;" type="submit">Buscar</button>
              </mat-card-actions>
            </form>
          </mat-card-content>
        </mat-card>
        <br>

        <mat-card class="magnum-card">
          <mat-card-header>
            <mat-card-title></mat-card-title>
            <mat-card-subtitle> Registros encontrados</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <div class="mat-elevation-z8">
              <form [formGroup]="VOForm" autocomplete="off">
                <ng-container formArrayName="VORows">
                  <table #table mat-table [dataSource]="dataSourceEditing" class="mat-elevation-z8">

                    <ng-container matColumnDef="codigo">
                      <th mat-header-cell *matHeaderCellDef> No. </th>
                      <td mat-cell *matCellDef="let element; let i = index" [formGroup]="element">
                        {{ element.get('codigo').value }}
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="detalle">
                      <th mat-header-cell *matHeaderCellDef> Detalle </th>
                      <td mat-cell *matCellDef="let element; let i = index" [formGroup]="element">
                        {{ element.get('detalle').value }}
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="depositouno">
                      <th mat-header-cell *matHeaderCellDef> Deposito 1</th>
                      <td mat-cell *matCellDef="let element; let i = index" [formGroup]="element">
                        <div *ngIf="VOForm.get('VORows').value[i].stockActualDepositoUno !=null; else elseBlock">
                          <mat-form-field style="width: 70px;">
                            <input matInput type="text" formControlName="stockActualDepositoUno"
                              [readonly]="VOForm.get('VORows').value[i].isEditableSADU" style="text-align: right;">
                          </mat-form-field>
                          <button mat-icon-button class="material-icons save-button" id="isEditableSADU" matTooltip="Guardar"
                            (click)="SaveVO(1,VOForm,i)" *ngIf="!VOForm.get('VORows').value[i].isEditableSADU" color="primary">
                            <mat-icon>check_circle</mat-icon>
                          </button>
                          <button mat-icon-button class="material-icons app-toolbar-menu cancel-button" id="isEditableSADU"
                            matTooltip="Cancelar" matTooltipClass="example-tooltip-red" color="warn"
                            (click)="CancelSVO(1, VOForm,i)" *ngIf="!VOForm.get('VORows').value[i].isEditableSADU">
                            <mat-icon>cancel</mat-icon>
                          </button>
                          <button mat-icon-button class="material-icons app-toolbar-menu save-button" id="isEditableSADU"
                            *ngIf="VOForm.get('VORows').value[i].isEditableSADU" matTooltip="Editar" color="primary"
                            (click)="EditSVO(1,VOForm,i)">
                            <mat-icon>edit</mat-icon>
                          </button>
                        </div>
                        <ng-template #elseBlock>
                          <label matTooltip="Antes de ajustar debe inicializar este stock.">(s.n.)</label>
                        </ng-template>
                      </td>
                    </ng-container>
                    <ng-container matColumnDef="depositodos">
                      <th mat-header-cell *matHeaderCellDef> Deposito 2</th>
                      <td mat-cell *matCellDef="let element; let i = index" [formGroup]="element">
                        <div *ngIf="VOForm.get('VORows').value[i].stockActualDepositoDos !=null; else elseBlock">
                          <mat-form-field style="width: 70px;">
                            <input matInput type="text" formControlName="stockActualDepositoDos"
                              [readonly]="VOForm.get('VORows').value[i].isEditableSADD" style="text-align: right;">
                          </mat-form-field>
                          <button mat-icon-button class="material-icons save-button" matTooltip="Guardar"
                            (click)="SaveVO(2,VOForm,i)" *ngIf="!VOForm.get('VORows').value[i].isEditableSADD" color="primary">
                            <mat-icon>check_circle</mat-icon>
                          </button>
                          <button mat-icon-button class="material-icons app-toolbar-menu cancel-button" matTooltip="Cancelar"
                            matTooltipClass="example-tooltip-red" color="warn" (click)="CancelSVO(2,VOForm,i)"
                            *ngIf="!VOForm.get('VORows').value[i].isEditableSADD">
                            <mat-icon>cancel</mat-icon>
                          </button>
                          <button mat-icon-button class="material-icons app-toolbar-menu save-button"
                            *ngIf="VOForm.get('VORows').value[i].isEditableSADD" matTooltip="Editar" color="primary"
                            (click)="EditSVO(2,VOForm,i)">
                            <mat-icon>edit</mat-icon>
                          </button>
                        </div>
                        <ng-template #elseBlock>
                          <label matTooltip="Antes de ajustar debe inicializar este stock.">(s.n.)</label>
                        </ng-template>

                      </td>
                    </ng-container>
                    <tr mat-header-row *matHeaderRowDef="columnasTabla"></tr>
                    <tr mat-row *matRowDef="let row; columns: columnasTabla;"></tr>

                  </table>
                </ng-container>
              </form>
              <mat-paginator #paginator [length]="totalRows" [pageIndex]="page - 1" [pageSizeOptions]="[5, 10, 50, 100]"
                (page)="pagesChange($event)" [pageSize]="pageSize" aria-label="Select page">
              </mat-paginator>
              <mat-card>Total Productos {{ totalRows }}</mat-card>
            </div>

          </mat-card-content>
          <mat-card-actions>

          </mat-card-actions>
        </mat-card>

   </div>
    </mat-card>
  </div>
</mat-card-content>

<app-footer></app-footer>
<app-global-spinner></app-global-spinner>
<app-global-snackbar></app-global-snackbar>






